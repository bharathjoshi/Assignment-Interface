(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{160:function(e,t,r){e.exports=r(325)},325:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),o=r(4),l=r.n(o),i=r(35),s=r(36),c=r(38),u=r(37),m=r(39),p=r(22),d=r(30),f=r(48),h=function(e){return e.children},g=r(328),y=r(10),E=r(326),v=r(330),w=r(91),b=r(116),O=r.n(b),T=function(e){return{type:"AUTH_SUCCESS",token:e.token}},S=function(e){return{type:"AUTH_FAIL",error:e}},k=function(){return localStorage.removeItem("user"),{type:"AUTH_LOGOUT"}},j=function(e){return function(t){setTimeout(function(){t(k())},1e3*e)}},A=function(e,t,r,a,n){return function(o){o({type:"AUTH_START"}),O.a.post("http://127.0.0.1:8000/rest-auth/registration/",{username:e,email:t,password1:r,password2:a,is_student:n,is_teacher:!n}).then(function(t){var r={username:e,token:t.data.key,expirationDate:new Date((new Date).getTime()+36e5),is_student:n,is_teacher:!n};localStorage.setItem("user",JSON.stringify(r)),o(T(r)),o(j(3600))}).catch(function(e){o(S(e))})}},x=g.a.Item,D=n.a.createElement(y.a,{type:"loading",style:{fontSize:24},spin:!0}),_=function(e){function t(){var e,r;Object(i.a)(this,t);for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return(r=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).handleSubmit=function(e){e.preventDefault(),r.props.form.validateFields(function(e,t){e||(r.props.onAuth(t.userName,t.password),r.props.history.push("/"))})},r}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=null;this.props.error&&(e=n.a.createElement("p",null,this.props.error.message));var t=this.props.form.getFieldDecorator;return n.a.createElement("div",null,e,this.props.loading?n.a.createElement(E.a,{indicator:D}):n.a.createElement(g.a,{onSubmit:this.handleSubmit,className:"login-form"},n.a.createElement(x,null,t("userName",{rules:[{required:!0,message:"Please input your username!"}]})(n.a.createElement(v.a,{prefix:n.a.createElement(y.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Username"}))),n.a.createElement(x,null,t("password",{rules:[{required:!0,message:"Please input your Password!"}]})(n.a.createElement(v.a,{prefix:n.a.createElement(y.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password"}))),n.a.createElement(x,null,n.a.createElement(w.a,{type:"primary",htmlType:"submit",style:{marginRight:"10px"}},"Login"),"Or",n.a.createElement(p.c,{style:{marginRight:"10px"},to:"/signup/"}," ","signup"))))}}]),t}(n.a.Component),P=g.a.create()(_),C=Object(d.b)(function(e){return{loading:e.auth.loading,error:e.auth.error}},function(e){return{onAuth:function(t,r){return e(function(e,t){return function(r){r({type:"AUTH_START"}),O.a.post("http://127.0.0.1:8000/rest-auth/login/",{username:e,password:t}).then(function(e){var t=e.data.key,a=new Date((new Date).getTime()+36e5);localStorage.setItem("token",t),localStorage.setItem("expirationDate",a),r(T(t)),r(j(3600))}).catch(function(e){r(S(e))})}}(t,r))}}})(P),I=r(329),U=g.a.Item,N=I.a.Option,F=function(e){function t(){var e,r;Object(i.a)(this,t);for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return(r=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).state={confirmDirty:!1},r.handleSubmit=function(e){e.preventDefault(),r.props.form.validateFieldsAndScroll(function(e,t){if(!e){var a=!1;"student"===t.userType&&(a=!0),r.props.onAuth(t.userName,t.email,t.password,t.confirm,a)}})},r.handleConfirmBlur=function(e){var t=e.target.value;r.setState({confirmDirty:r.state.confirmDirty||!!t})},r.compareToFirstPassword=function(e,t,a){var n=r.props.form;t&&t!==n.getFieldValue("password")?a("Two passwords that you enter is inconsistent!"):a()},r.validateToNextPassword=function(e,t,a){var n=r.props.form;t&&r.state.confirmDirty&&n.validateFields(["confirm"],{force:!0}),a()},r}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return n.a.createElement(g.a,{onSubmit:this.handleSubmit},n.a.createElement(U,null,e("userName",{rules:[{required:!0,message:"Please input your username!"}]})(n.a.createElement(v.a,{prefix:n.a.createElement(y.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Username"}))),n.a.createElement(U,null,e("email",{rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your E-mail!"}]})(n.a.createElement(v.a,{prefix:n.a.createElement(y.a,{type:"mail",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Email"}))),n.a.createElement(U,null,e("password",{rules:[{required:!0,message:"Please input your password!"},{validator:this.validateToNextPassword}]})(n.a.createElement(v.a,{prefix:n.a.createElement(y.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password"}))),n.a.createElement(U,null,e("confirm",{rules:[{required:!0,message:"Please confirm your password!"},{validator:this.compareToFirstPassword}]})(n.a.createElement(v.a,{prefix:n.a.createElement(y.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password",onBlur:this.handleConfirmBlur}))),n.a.createElement(U,null,e("userType",{rules:[{required:!0,message:"Please select a user!"}]})(n.a.createElement(I.a,{placeholder:"Select a user type"},n.a.createElement(N,{value:"student"},"Student"),n.a.createElement(N,{value:"teacher"},"Teacher")))),n.a.createElement(U,null,n.a.createElement(w.a,{type:"primary",htmlType:"submit",style:{marginRight:"10px"}},"Signup"),"Or",n.a.createElement(p.c,{style:{marginRight:"10px"},to:"/login/"},"login")))}}]),t}(n.a.Component),H=g.a.create()(F),q=Object(d.b)(function(e){return{loading:e.auth.loading,error:e.auth.error}},function(e){return{onAuth:function(t,r,a,n,o){return e(A(t,r,a,n,o))}}})(H),R=g.a.Item,L=I.a.Option,B=function(e){function t(){var e,r;Object(i.a)(this,t);for(var a=arguments.length,n=new Array(a),o=0;o<a;o++)n[o]=arguments[o];return(r=Object(c.a)(this,(e=Object(u.a)(t)).call.apply(e,[this].concat(n)))).state={confirmDirty:!1},r.handleSubmit=function(e){e.preventDefault(),r.props.form.validateFieldsAndScroll(function(e,t){if(!e){var a=!1;"student"===t.userType&&(a=!0),r.props.onAuth(t.userName,t.email,t.password,t.confirm,a)}})},r.handleConfirmBlur=function(e){var t=e.target.value;r.setState({confirmDirty:r.state.confirmDirty||!!t})},r.compareToFirstPassword=function(e,t,a){var n=r.props.form;t&&t!==n.getFieldValue("password")?a("Two passwords that you enter is inconsistent!"):a()},r.validateToNextPassword=function(e,t,a){var n=r.props.form;t&&r.state.confirmDirty&&n.validateFields(["confirm"],{force:!0}),a()},r}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this.props.form.getFieldDecorator;return n.a.createElement(g.a,{onSubmit:this.handleSubmit},n.a.createElement(R,null,e("userName",{rules:[{required:!0,message:"Please input your username!"}]})(n.a.createElement(v.a,{prefix:n.a.createElement(y.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Username"}))),n.a.createElement(R,null,e("email",{rules:[{type:"email",message:"The input is not valid E-mail!"},{required:!0,message:"Please input your E-mail!"}]})(n.a.createElement(v.a,{prefix:n.a.createElement(y.a,{type:"mail",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Email"}))),n.a.createElement(R,null,e("password",{rules:[{required:!0,message:"Please input your password!"},{validator:this.validateToNextPassword}]})(n.a.createElement(v.a,{prefix:n.a.createElement(y.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password"}))),n.a.createElement(R,null,e("confirm",{rules:[{required:!0,message:"Please confirm your password!"},{validator:this.compareToFirstPassword}]})(n.a.createElement(v.a,{prefix:n.a.createElement(y.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password",onBlur:this.handleConfirmBlur}))),n.a.createElement(R,null,e("userType",{rules:[{required:!0,message:"Please select a user!"}]})(n.a.createElement(I.a,{placeholder:"Select a user type"},n.a.createElement(L,{value:"student"},"Student"),n.a.createElement(L,{value:"teacher"},"Teacher")))),n.a.createElement(R,null,n.a.createElement(w.a,{type:"primary",htmlType:"submit",style:{marginRight:"10px"}},"Signup"),"Or",n.a.createElement(p.c,{style:{marginRight:"10px"},to:"/login/"},"login")))}}]),t}(n.a.Component),W=g.a.create()(B),J=Object(d.b)(function(e){return{loading:e.auth.loading,error:e.auth.error}},function(e){return{onAuth:function(t,r,a,n,o){return e(A(t,r,a,n,o))}}})(W),V=function(){return n.a.createElement(h,null,n.a.createElement(f.a,{path:"/login",component:C}),n.a.createElement(f.a,{path:"/signup",component:q}),n.a.createElement(f.a,{exact:!0,path:"/",component:J}))},z=(r(323),r(327)),G=r(120),M=r(331),X=z.a.Header,K=z.a.Content,Q=z.a.Footer,$=function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return n.a.createElement(z.a,{className:"layout"},n.a.createElement(X,null,n.a.createElement("div",{className:"logo"}),n.a.createElement(G.a,{theme:"dark",mode:"horizontal",defaultSelectedKeys:["2"],style:{lineHeight:"64px"}},this.props.isAuthenticated?n.a.createElement(G.a.Item,{key:"2",onClick:this.props.logout},"Logout"):n.a.createElement(G.a.Item,{key:"2"},n.a.createElement(p.b,{to:"/login"},"Login")))),n.a.createElement(K,{style:{padding:"0 50px"}},n.a.createElement(M.a,{style:{margin:"16px 0"}},n.a.createElement(M.a.Item,null,n.a.createElement(p.b,{to:"/"},"Home")),null!==this.props.token?n.a.createElement(M.a.Item,null,n.a.createElement(p.b,{to:"/profile/".concat(this.props.userId)},"Profile")):null,null!==this.props.token&&this.props.is_teacher?n.a.createElement(M.a.Item,null,n.a.createElement(p.b,{to:"/create"},"Create")):null),n.a.createElement("div",{style:{background:"#fff",padding:24,minHeight:280}},this.props.children)),n.a.createElement(Q,{style:{textAlign:"center"}},"Ant Design \xa92016 Created by Ant UED"))}}]),t}(n.a.Component),Y=Object(f.e)(Object(d.b)(function(e){return{userId:e.auth.userId,token:e.auth.token,is_teacher:e.auth.is_teacher}},function(e){return{logout:function(){return e(k())}}})($)),Z=(r(324),function(e){function t(){return Object(i.a)(this,t),Object(c.a)(this,Object(u.a)(t).apply(this,arguments))}return Object(m.a)(t,e),Object(s.a)(t,[{key:"componentDidMount",value:function(){this.props.onTryAutoSignup()}},{key:"render",value:function(){return n.a.createElement(p.a,null,n.a.createElement(Y,this.props,n.a.createElement(V,null)))}}]),t}(a.Component)),ee=Object(d.b)(function(e){return{isAuthenticated:null!==e.auth.token}},function(e){return{onTryAutoSignup:function(){return e(function(e){var t=localStorage.getItem("user");if(void 0===t||null===t)e(k());else{var r=new Date(t.expirationDate);r<=new Date?e(k()):(e(T(t)),e(j((r.getTime()-(new Date).getTime())/1e3)))}})}}})(Z),te=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function re(e){navigator.serviceWorker.register(e).then(function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(e){console.error("Error during service worker registration:",e)})}var ae=r(53),ne=r(157),oe=r(158),le=function(e,t){return Object(oe.a)({},e,t)},ie={is_student:null,is_teacher:null,token:null,error:null,loading:!1,username:null},se=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"AUTH_START":return function(e,t){return le(e,{error:null,loading:!0})}(e);case"AUTH_SUCCESS":return function(e,t){return le(e,{token:t.user.token,username:t.user.username,is_student:t.user.is_student,is_teacher:t.user.is_teacher,error:null,loading:!1})}(e,t);case"AUTH_FAIL":return function(e,t){return le(e,{error:t.error,loading:!1})}(e,t);case"AUTH_LOGOUT":return function(e,t){return le(e,{token:null})}(e);default:return e}},ce=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||ae.d,ue=Object(ae.c)({auth:se}),me=Object(ae.e)(ue,ce(Object(ae.a)(ne.a))),pe=n.a.createElement(d.a,{store:me},n.a.createElement(ee,null));l.a.render(pe,document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var e="".concat("","/service-worker.js");te?(function(e){fetch(e).then(function(t){404===t.status||-1===t.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(e){e.unregister().then(function(){window.location.reload()})}):re(e)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}(e),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):re(e)})}}()}},[[160,1,2]]]);
//# sourceMappingURL=main.ced07585.chunk.js.map